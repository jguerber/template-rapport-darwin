% !TeX root = main.tex

\documentclass[12pt]{article}

\usepackage[french]{babel}
\usepackage[T1]{fontenc}

\usepackage{lipsum}

% set page geometry
\usepackage{geometry}

\geometry{
    a4paper,
    left=25mm,
    right=25mm,
    top=25mm,
    bottom=25mm
}

% times new roman
\usepackage{mathptmx}

%linespacing
\usepackage{setspace}
\onehalfspacing{}

% useful packages
\usepackage{amsmath}
\usepackage{amsfonts}

\usepackage{graphicx}
\usepackage{wrapfig}
\usepackage{float}

\usepackage{framed}

\usepackage{multicol}


%load bibliography
\usepackage[backend=biber, 
    citestyle=authoryear, 
    bibstyle=verbose, 
    datamodel=datamodels, % charge datamodels.dbx
    maxbibnames=999, 
    maxcitenames=2, 
    natbib, 
    sorting = nyt, 
    doi=true, 
    date = year]{biblatex}
\usepackage{csquotes}

%%%% Gestion de la biblio

% chargement
\addbibresource{biblio.bib}

% package pour refaire les macros
\usepackage{xpatch}

% asterisque devant options={extsym={*}}
\makeatletter
\providecommand{\bib@extsym}{}
\DeclareEntryOption[string]{extsym}{\renewcommand{\bib@extsym}{#1}}
\renewbibmacro*{begentry}{\textbf{\printtext{\bib@extsym}}}
\makeatother

% on enleve les champs useless
\renewbibmacro{in:}{} % "in" devant le nom de revue
\renewbibmacro{urldate}{} % date de téléchargement du pdf
\renewbibmacro{url}{} % url (redondant si on a le doi)

\AtEveryBibitem{
    \clearfield{issn} % issn
    \clearlist{language} % langue de l'article
}

% (pas compris pourquoi des fois ça doit etre renewbibmacro
% et des fois AtEveryBibItem mais ça marche)

% on ajoute mynote à la fin
\xapptobibmacro{finentry}{\par\textbf{\printfield{mynote}}}{}{}

% citations en police normale
\AtBeginDocument{\protected\def\mkbibnamefamily#1{%
\textnohyphenation{#1}}}

% définit \beginsupplement pour le début de l'annexe
\newcommand{\beginsupplement}{
        \setcounter{table}{0}
        \renewcommand{\thetable}{S\arabic{table}}%
        \setcounter{figure}{0}
        \renewcommand{\thefigure}{S\arabic{figure}}%
     }

\input{style/style.tex} % inclure la feuille de style

\begin{document}

\pagenumbering{roman} % petits chiffres romains pour les pages hors 30 pages

\setcounter{tocdepth}{2}
\tableofcontents

\pagebreak

\input{chapters/abstract.tex}

\pagebreak
\pagenumbering{arabic} % chiffres arabes pour les 30 pages

\input{chapters/intro.tex}

\pagebreak

%small spacing for biblio
\singlespacing{}

\addcontentsline{toc}{section}{Références}
\printbibliography{}

\pagebreak
\pagenumbering{Roman} % grands chiffres romains pour l'annexe

%normal spacing for supplementary
\onehalfspacing{}
\beginsupplement{}
\input{chapters/supplementary.tex}

\end{document}